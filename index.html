<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />

    <!-- ✅ Universal: app dark-first (evita heurísticas del navegador/WebView) -->
    <meta name="color-scheme" content="dark" />

    <title>App Geocercas</title>

    <!-- PWA / Google Play -->
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="theme-color" content="#10b981" />

    <!-- Leaflet / Geoman CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@geoman-io/leaflet-geoman-free@2.18.3/dist/leaflet-geoman.css"
    />

    <style>
      html,
      body,
      #root {
        height: 100%;
        margin: 0;
      }
      html {
        background: #0b1220;
      }
      body {
        background: #0b1220;
      }
    </style>

    <!-- Shim crítico: disponible ANTES del bundle -->
    <script>
      (function () {
        if (!window.process) window.process = {};
        if (!window.process.env) window.process.env = {};
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>

    <!-- ✅ Cargar Vercel Feedback SOLO si tú lo pides:
         - En localhost (dev)
         - O si agregas ?feedback=1
         - O si NO estás en tu dominio de producción
    -->
    <script type="module">
      (function () {
        try {
          const host = window.location.hostname;
          const params = new URLSearchParams(window.location.search);
          const force = params.get("feedback") === "1";

          const isLocal = host === "localhost" || host === "127.0.0.1";
          const isProdDomain = host === "www.tugeocercas.com" || host === "tugeocercas.com";

          // Activo en dev/preview o bajo demanda
          const shouldLoad = force || isLocal || !isProdDomain;

          if (!shouldLoad) return;

          const s = document.createElement("script");
          s.async = true;
          s.setAttribute("data-explicit-opt-in", "true");
          s.setAttribute("data-cookie-opt-in", "true");
          // opcional: si lo quieres fijo, déjalo; si no, quítalo
          s.setAttribute("data-deployment-id", "dpl_AioyQVyGHzqvpdFFs4Bwgsvvj82N");
          s.src = "https://vercel.live/_next-live/feedback/feedback.js";
          document.head.appendChild(s);
        } catch (e) {
          // nunca romper por esto
          console.warn("[feedback-loader] skipped:", e);
        }
      })();
    </script>

    <!-- Vite entry -->
    <script type="module" crossorigin src="/assets/index-BMEvrOl6.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-U9V-HtFP.css" />
  </body>
</html>
